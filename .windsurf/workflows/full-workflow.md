# DocDD 完全開発フロー

このワークフローは、DocDDの11フェーズすべてを順次実行し、高品質なコード変更を保証します。

## 実行方法
Windsurf Cascadeで `/full-workflow` と入力してください。

---

## Phase 1: Investigation & Research【必須】

### Step 1-1: ADR確認
1. `docs/adr/index.json` を確認
2. 関連するADRファイル（`docs/adr/decisions/*.json`）を読み取る
3. 既存のアーキテクチャ決定との整合性を検証
4. 矛盾がある場合は明示的に報告

### Step 1-2: コードベース調査
1. 関連するファイルとディレクトリ構造を特定
2. 既存のコーディングパターンを分析
3. 依存関係を確認（import文、使用ライブラリ等）

### Step 1-3: ライブラリドキュメント確認（必要に応じて）
1. 使用予定のライブラリの最新ドキュメントを確認
2. 破壊的変更やベストプラクティスの更新をチェック

### 完了確認
- [ ] ADRを確認し理解した
- [ ] 実装アプローチが既存の決定に沿っている
- [ ] 関連コードを特定した

---

## Phase 2: Architecture Design【新機能/大規模変更時】

### Step 2-1: ファイル配置設計
1. 新規ファイルの配置場所を決定
2. ディレクトリ構造が既存パターンに従うことを確認
3. 命名規則の一貫性を保つ

### Step 2-2: 状態管理アプローチ
1. どこでどのように状態を管理するか定義
2. Props Drilling / React Context / 外部ライブラリの選択
3. 決定理由を文書化

### Step 2-3: コンポーネント設計
1. コンポーネントの責務を明確化
2. データフロー（props/context/イベント）を設計
3. Presenterパターン等の確立されたパターンを適用

### Step 2-4: ADR記録（重要な決定の場合）
1. 新しいADR番号を取得
2. `docs/adr/decisions/{番号}-{タイトル}.json` を作成
3. `docs/adr/index.json` を更新

### 完了確認（該当する場合）
- [ ] ファイル配置が決定された
- [ ] 状態管理方針が明確
- [ ] ADRが記録された（重要な決定の場合）

---

## Phase 3: UI/UX Design【UI変更時】

### Step 3-1: デザインレビュー
1. プロジェクトスタイルガイドに対してデザインを確認
2. アクセシビリティ要件（ARIA、キーボードナビゲーション）を検証
3. レスポンシブデザイン（モバイル、タブレット、デスクトップ）を考慮

### Step 3-2: 実装前の承認
1. 提案するUI変更を明確に説明
2. 必要に応じてスクリーンショットやモックアップを提示
3. **ユーザーの明示的な承認を得る**

### 完了確認（UI変更の場合）
- [ ] アクセシビリティを考慮した設計
- [ ] レスポンシブデザインが適切
- [ ] ユーザーの承認を得た

---

## Phase 4: Planning【必須】

### Step 4-1: タスク分解
1. 作業を具体的な小ステップに分割
2. 各タスクが独立して完了可能であることを確認
3. 1タスクあたり5-15分程度を目安に

### Step 4-2: 実装順序の定義
1. 依存関係を考慮した順序付け
2. テスト可能な単位で区切る

### Step 4-3: 依存関係の特定
1. 他のコンポーネント/モジュールへの依存
2. 外部ライブラリの追加が必要か確認
3. 不明点や曖昧な点をリストアップ

### 完了確認
- [ ] タスクが明確に定義された
- [ ] 実装順序が決定された
- [ ] すべての要件が明確

---

## Phase 5: Implementation【必須】

### Step 5-1: コード実装
1. 計画に基づいてコードを実装
2. **明示的な `@/` インポートを使用**（バレルインポート禁止）
3. 厳格なTypeScript型付け（`any` 禁止、`@ts-ignore` 禁止）
4. 日本語コメントで意図を文書化

### Step 5-2: コーディング標準の遵守
1. 命名規則（キャメルケース等）を守る
2. エラーハンドリング（非同期は `.then().catch()`）
3. Server Components優先、必要な場合のみClient Components

### 完了確認
- [ ] コードが実装された
- [ ] コーディング標準に準拠
- [ ] 日本語コメントが適切に記述された

---

## Phase 6: Testing & Stories【ロジック変更時】

### Step 6-1: テスト作成
1. AAAパターン（Arrange-Act-Assert）でテストを生成
2. 日本語のテストタイトルを使用：`[条件]の場合、[期待される結果]こと`
3. クリティカルパスの100%ブランチカバレッジを確保

### Step 6-2: Storybookストーリー作成（UIコンポーネントの場合）
1. 主要な状態バリエーションのストーリーを作成
2. 条件分岐ごとにストーリーを定義

### 完了確認（ロジック変更の場合）
- [ ] テストが作成された
- [ ] AAAパターンに従っている
- [ ] カバレッジが十分

---

## Phase 7: Code Review【リファクタリング時】

### Step 7-1: SOLID原則チェック
1. 単一責任の原則を確認
2. コードの重複がないか確認
3. 継承よりコンポジションを優先しているか

### Step 7-2: コードスメル検出
1. 長すぎる関数（100行超）がないか
2. 複雑すぎるロジックがないか
3. マジックナンバーがないか

### Step 7-3: パフォーマンス考慮
1. 不要な再レンダリングがないか
2. 重い計算はメモ化されているか

### 完了確認（複雑なコードの場合）
- [ ] SOLID原則に従っている
- [ ] コードスメルがない
- [ ] パフォーマンスが考慮されている

---

## Phase 8: Quality Checks【必須】

### Step 8-1: すべての品質チェックを実行
```bash
# 1. 型チェック
npm run type-check

# 2. リント
npm run lint

# 3. テスト
npm run test

# 4. ビルド
npm run build
```

### Step 8-2: エラー修正
1. すべてのエラーを修正
2. `@ts-ignore` や `eslint-disable` を使用しない

### 完了確認
- [ ] type-check: エラーなし
- [ ] lint: エラーなし
- [ ] test: すべてパス
- [ ] build: 成功

---

## Phase 9A: Runtime Verification【必須】

### Step 9A-1: 開発サーバー起動
```bash
npm run dev
```

### Step 9A-2: ランタイムエラーチェック
1. コンパイルエラーがないことを確認
2. すべてのルートが認識されていることを確認
3. HTTPレスポンスが正しいことを確認（200 OK）

### 完了確認
- [ ] 開発サーバーが起動する
- [ ] ランタイムエラーがない
- [ ] 主要ページが正常に動作

---

## Phase 9B: Browser Verification【複雑なUIの場合】

### Step 9B-1: ブラウザでの動作確認
1. 主要なユーザーフローを実行
2. ボタンクリック、フォーム入力、ナビゲーション等を検証
3. エラーが発生しないことを確認

### Step 9B-2: レスポンシブテスト（必要に応じて）
1. モバイル（375px）
2. タブレット（768px）
3. デスクトップ（1920px）

### 完了確認（複雑なUIの場合）
- [ ] ユーザーフローが正常に動作
- [ ] レスポンシブデザインが正しい
- [ ] ブラウザコンソールにエラーなし

---

## Phase 10: Git Commit【必須】

### Step 10-1: コミット
```bash
git add .
git commit -m "<type>: <description>"
```

**Type**: feat, fix, refactor, docs, test, style, chore

**例**:
- `feat: ユーザー認証機能を追加`
- `fix: ログイン時のエラーを修正`
- `refactor: UserCard コンポーネントを分割`

### 完了確認
- [ ] 適切なコミットメッセージ
- [ ] 1コミット = 1つの論理的変更

---

## Phase 11: Push【必須】

### Step 11-1: プッシュ
```bash
git push origin <branch-name>
```

### Step 11-2: プルリクエスト作成（該当する場合）
1. 変更内容の説明を記載
2. レビュアーを指定
3. 関連Issueを紐付け

### 完了確認
- [ ] プッシュが成功
- [ ] リモートリポジトリに反映されている

---

## ワークフロー完了

すべてのフェーズが完了しました！🎉

次のステップ:
- CI/CDパイプラインの確認
- コードレビューの依頼
- デプロイの準備
